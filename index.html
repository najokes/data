<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π - AI-–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è–º–∏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: #f5f7fa;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.08);
            overflow: hidden;
            border: 1px solid #e0e0e0;
        }
        
        header {
            background: white;
            color: #1a237e;
            padding: 30px;
            text-align: center;
            border-bottom: 3px solid #d32f2f;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: #d32f2f;
            font-weight: 600;
        }
        
        .subtitle {
            opacity: 0.9;
            font-size: 1.2rem;
            color: #666;
            margin-bottom: 25px;
        }
        
        .header-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        
        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            min-width: 200px;
            text-align: center;
            border: 2px solid #d32f2f;
            box-shadow: 0 4px 12px rgba(211, 47, 47, 0.1);
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 5px;
            color: #d32f2f;
        }
        
        .stat-label {
            font-size: 1rem;
            color: #666;
        }
        
        .header-actions {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .header-btn {
            background: white;
            color: #d32f2f;
            border: 2px solid #d32f2f;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 10px;
            white-space: nowrap;
        }
        
        .header-btn:hover {
            background: #d32f2f;
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(211, 47, 47, 0.2);
        }
        
        .header-btn.primary {
            background: #d32f2f;
            color: white;
            border: none;
        }
        
        .header-btn.primary:hover {
            background: #b71c1c;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(183, 28, 28, 0.3);
        }
        
        .main-content {
            padding: 30px;
        }
        
        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .section-title {
            color: #d32f2f;
            font-size: 1.8rem;
            font-weight: 600;
        }
        
        .search-filter-container {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .search-input {
            padding: 12px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            min-width: 300px;
            transition: all 0.3s;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #d32f2f;
            box-shadow: 0 0 0 3px rgba(211, 47, 47, 0.1);
        }
        
        .filter-select {
            padding: 12px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            background: white;
            color: #333;
            min-width: 200px;
        }
        
        .filter-select:focus {
            outline: none;
            border-color: #d32f2f;
        }
        
        /* –¢–∞–±–ª–∏—Ü–∞ –∫–æ–º–ø–∞–Ω–∏–π */
        .companies-table-container {
            background: white;
            border-radius: 10px;
            border: 1px solid #e0e0e0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.03);
            overflow: hidden;
            margin-top: 20px;
        }
        
        .companies-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .companies-table th {
            background: #d32f2f;
            color: white;
            padding: 20px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid #b71c1c;
            position: sticky;
            top: 0;
            z-index: 10;
            font-size: 1.1rem;
        }
        
        .companies-table td {
            padding: 18px 20px;
            border-bottom: 1px solid #f0f0f0;
            color: #333;
            font-size: 1rem;
        }
        
        .companies-table tr:hover {
            background-color: #fff5f5;
        }
        
        .company-row {
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .company-row:hover {
            background-color: #ffebee !important;
            transform: translateX(3px);
        }
        
        .company-logo-small {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #d32f2f 0%, #b71c1c 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .company-name-cell {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .company-info {
            display: flex;
            flex-direction: column;
        }
        
        .company-name {
            font-weight: 600;
            color: #1a237e;
            font-size: 1.1rem;
            margin-bottom: 5px;
        }
        
        .company-desc {
            font-size: 0.9rem;
            color: #666;
            line-height: 1.4;
        }
        
        .sector-badge {
            display: inline-block;
            padding: 6px 14px;
            border-radius: 12px;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .sector-tech {
            background: rgba(66, 133, 244, 0.1);
            color: #4285f4;
            border: 1px solid rgba(66, 133, 244, 0.2);
        }
        
        .sector-retail {
            background: rgba(234, 67, 53, 0.1);
            color: #ea4335;
            border: 1px solid rgba(234, 67, 53, 0.2);
        }
        
        .sector-manufacturing {
            background: rgba(251, 188, 5, 0.1);
            color: #fbbc05;
            border: 1px solid rgba(251, 188, 5, 0.2);
        }
        
        .sector-finance {
            background: rgba(52, 168, 83, 0.1);
            color: #34a853;
            border: 1px solid rgba(52, 168, 83, 0.2);
        }
        
        .sector-energy {
            background: rgba(139, 69, 19, 0.1);
            color: #8b4513;
            border: 1px solid rgba(139, 69, 19, 0.2);
        }
        
        .sector-construction {
            background: rgba(255, 107, 53, 0.1);
            color: #ff6b35;
            border: 1px solid rgba(255, 107, 53, 0.2);
        }
        
        .metric-value-cell {
            text-align: right;
            font-weight: 600;
        }
        
        .roi-cell {
            font-size: 1.2rem;
            font-weight: 700;
        }
        
        .roi-positive {
            color: #27ae60;
        }
        
        .roi-negative {
            color: #e74c3c;
        }
        
        .inn-cell {
            font-family: monospace;
            background: #f8f9fa;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.95rem;
        }
        
        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 30px;
            align-items: center;
        }
        
        .page-btn {
            padding: 10px 16px;
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 8px;
            color: #666;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1rem;
            font-weight: 500;
        }
        
        .page-btn:hover:not(:disabled) {
            background: #e9ecef;
            transform: translateY(-2px);
        }
        
        .page-btn.active {
            background: #d32f2f;
            color: white;
            border-color: #d32f2f;
        }
        
        .page-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .page-info {
            color: #666;
            font-size: 0.95rem;
            margin: 0 15px;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 18px 28px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            z-index: 1000;
            animation: slideIn 0.3s ease;
            border: 1px solid;
            background: white;
            min-width: 300px;
            max-width: 400px;
        }
        
        .success {
            background: rgba(39, 174, 96, 0.95);
            color: white;
            border-color: #27ae60;
        }
        
        .info {
            background: rgba(52, 152, 219, 0.95);
            color: white;
            border-color: #3498db;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
        
        .export-section {
            margin-top: 30px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 1px solid #e0e0e0;
            text-align: center;
        }
        
        .export-title {
            color: #d32f2f;
            font-size: 1.3rem;
            margin-bottom: 20px;
            font-weight: 600;
        }
        
        .export-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .export-btn {
            background: white;
            border: 2px solid #d32f2f;
            color: #d32f2f;
            padding: 15px 30px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1rem;
        }
        
        .export-btn:hover {
            background: #d32f2f;
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(211, 47, 47, 0.2);
        }
        
        .export-btn.secondary {
            border-color: #1a237e;
            color: #1a237e;
        }
        
        .export-btn.secondary:hover {
            background: #1a237e;
            color: white;
            box-shadow: 0 5px 15px rgba(26, 35, 126, 0.2);
        }
        
        .mobile-warning {
            display: none;
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        @media (max-width: 768px) {
            .container {
                border-radius: 8px;
            }
            
            header {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            .search-input {
                min-width: 100%;
            }
            
            .filter-select {
                min-width: 100%;
            }
            
            .mobile-warning {
                display: block;
            }
            
            .companies-table {
                display: block;
                overflow-x: auto;
            }
            
            .header-stats {
                gap: 15px;
            }
            
            .stat-card {
                min-width: 150px;
                padding: 15px;
            }
            
            .stat-value {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="mobile-warning">
        üì± –î–ª—è –ª—É—á—à–µ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è —ç–∫—Ä–∞–Ω–∞ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
    </div>
    
    <div class="container">
        <header>
            <h1>–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π</h1>
            <p class="subtitle">AI-–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏—è–º–∏ | –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –∫–æ–º–ø–∞–Ω–∏–π</p>
            
            <div class="header-stats">
                <div class="stat-card">
                    <div class="stat-value" id="statTotal">1,247</div>
                    <div class="stat-label">–í—Å–µ–≥–æ –∫–æ–º–ø–∞–Ω–∏–π</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="statActive">934</div>
                    <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö (ROI > 10%)</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="statUpdated">–°–µ–≥–æ–¥–Ω—è</div>
                    <div class="stat-label">–û–±–Ω–æ–≤–ª–µ–Ω–æ</div>
                </div>
            </div>
            
            <div class="header-actions">
                <button class="header-btn" onclick="addRandomCompany()">
                    <span style="font-size: 1.3rem;">+</span> –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∫–æ–º–ø–∞–Ω–∏—é
                </button>
                <button class="header-btn primary" onclick="importExternalData()">
                    üìÅ –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
                </button>
            </div>
        </header>
        
        <div class="main-content">
            <div class="content-header">
                <h2 class="section-title">–°–ø–∏—Å–æ–∫ –∫–æ–º–ø–∞–Ω–∏–π</h2>
                
                <div class="search-filter-container">
                    <input type="text" 
                           class="search-input" 
                           id="searchInput" 
                           placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏–ª–∏ –ò–ù–ù..."
                           onkeyup="searchCompanies()">
                    
                    <select class="filter-select" id="sectorFilter" onchange="filterBySector()">
                        <option value="all">–í—Å–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è</option>
                        <option value="–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</option>
                        <option value="–§–∏–Ω–∞–Ω—Å—ã">–§–∏–Ω–∞–Ω—Å—ã</option>
                        <option value="–†–∏—Ç–µ–π–ª">–†–∏—Ç–µ–π–ª</option>
                        <option value="–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ">–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ</option>
                        <option value="–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞">–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞</option>
                        <option value="–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ">–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ</option>
                    </select>
                </div>
            </div>
            
            <!-- –°–ø–∏—Å–æ–∫ –∫–æ–º–ø–∞–Ω–∏–π –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
            <div class="companies-table-container">
                <table class="companies-table" id="companiesTable">
                    <thead>
                        <tr>
                            <th style="width: 35%;">–ö–æ–º–ø–∞–Ω–∏—è</th>
                            <th style="width: 12%;">–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</th>
                            <th style="width: 12%;">–ò–ù–ù</th>
                            <th style="width: 10%;">ROI</th>
                            <th style="width: 12%;">–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏</th>
                            <th style="width: 9%;">–ö–ª–∏–µ–Ω—Ç—ã</th>
                            <th style="width: 10%;">R&D</th>
                        </tr>
                    </thead>
                    <tbody id="companiesTableBody">
                        <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ JavaScript -->
                    </tbody>
                </table>
            </div>
            
            <div class="pagination" id="pagination">
                <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ -->
            </div>
            
            <div class="export-section">
                <h3 class="export-title">–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</h3>
                <div class="export-buttons">
                    <button class="export-btn" onclick="exportToCSV()">
                        üì• –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV
                    </button>
                    <button class="export-btn secondary" onclick="exportToExcel()">
                        üìä –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
                    </button>
                    <button class="export-btn" onclick="generateReport()">
                        üìÑ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á–µ—Ç
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –•—Ä–∞–Ω–∏–ª–∏—â–µ –∫–æ–º–ø–∞–Ω–∏–π
        let companiesDatabase = {};
        let currentPage = 1;
        const companiesPerPage = 25;
        let currentFilter = 'all';
        let currentSearch = '';
        let totalCompanies = 0;

        // –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–æ–º–ø–∞–Ω–∏–π
        const companyDataGenerator = {
            sectors: [
                "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏", "–†–∏—Ç–µ–π–ª", "–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ", "–§–∏–Ω–∞–Ω—Å—ã", 
                "–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞", "–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ", "–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç", "–ó–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ",
                "–¢–µ–ª–µ–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏", "–ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å", "–°–µ–ª—å—Å–∫–æ–µ —Ö–æ–∑—è–π—Å—Ç–≤–æ"
            ],
            
            companyTypes: ["–û–û–û", "–ê–û", "–ü–ê–û", "–ó–ê–û"],
            
            prefixes: ["–¢–µ—Ö–Ω–æ", "–ü—Ä–æ–º", "–ò–Ω–≤–µ—Å—Ç", "–§–∏–Ω–∞–Ω—Å", "–°—Ç—Ä–æ–π", "–≠–Ω–µ—Ä–≥–æ", "–¢—Ä–∞–Ω—Å", "–ú–µ–¥", "–ê–≥—Ä–æ", "–¢–µ–ª–µ–∫–æ–º"],
            
            suffixes: ["–ì—Ä—É–ø–ø", "–•–æ–ª–¥–∏–Ω–≥", "–ê–ª—å—è–Ω—Å", "–ü–∞—Ä—Ç–Ω–µ—Ä", "–ö–∞–ø–∏—Ç–∞–ª", "–†–µ—Å—É—Ä—Å", "–°–µ—Ä–≤–∏—Å", "–¶–µ–Ω—Ç—Ä", "–°–∏—Å—Ç–µ–º—ã"],
            
            generateINN: () => {
                const prefix = Math.random() > 0.5 ? "77" : "78";
                const middle = Math.floor(Math.random() * 900000000).toString().padStart(9, '0');
                const control = Math.floor(Math.random() * 10);
                return prefix + middle + control;
            },
            
            generateCompanyName: () => {
                const type = this.companyTypes[Math.floor(Math.random() * this.companyTypes.length)];
                const prefix = this.prefixes[Math.floor(Math.random() * this.prefixes.length)];
                const suffix = this.suffixes[Math.floor(Math.random() * this.suffixes.length)];
                return `${type} "${prefix}${suffix}"`;
            },
            
            generateDescription: (sector) => {
                const employeeCount = Math.floor(Math.random() * 5000) + 50;
                const year = 2000 + Math.floor(Math.random() * 24);
                const adjectives = ["–≤–µ–¥—É—â–∞—è", "–¥–∏–Ω–∞–º–∏—á–Ω–æ —Ä–∞–∑–≤–∏–≤–∞—é—â–∞—è—Å—è", "–∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω–∞—è", "–Ω–∞–¥–µ–∂–Ω–∞—è", "—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è"];
                const adjective = adjectives[Math.floor(Math.random() * adjectives.length)];
                return `${adjective} –∫–æ–º–ø–∞–Ω–∏—è –≤ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ ${sector}, –æ—Å–Ω–æ–≤–∞–Ω–∞ –≤ ${year} –≥–æ–¥—É, ${employeeCount} —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤`;
            }
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
        function initializeDatabase() {
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–º–ø–∞–Ω–∏–π
            for (let i = 0; i < 1247; i++) {
                const sector = companyDataGenerator.sectors[Math.floor(Math.random() * companyDataGenerator.sectors.length)];
                const inn = companyDataGenerator.generateINN();
                const name = companyDataGenerator.generateCompanyName();
                const description = companyDataGenerator.generateDescription(sector);
                
                // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫
                const metrics = generateSectorMetrics(sector);
                
                companiesDatabase[inn] = {
                    id: `company_${i}`,
                    name: name,
                    description: description,
                    sector: sector,
                    logo: name.charAt(0),
                    
                    // –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
                    investmentAmount: metrics.investmentAmount,
                    historicalRoi: metrics.historicalRoi,
                    rdBudget: metrics.rdBudget,
                    projectCount: metrics.projectCount,
                    customerCount: metrics.customerCount,
                    currentChurn: metrics.currentChurn,
                    avgLtv: metrics.avgLtv,
                    infraCapex: metrics.infraCapex
                };
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏
            addRealCompanies();
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–Ω–¥–µ—Ä–∏–º —Ç–∞–±–ª–∏—Ü—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
            updateStats();
            renderCompaniesTable();
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–µ–∫—Ç–æ—Ä–∞
        function generateSectorMetrics(sector) {
            const baseMetrics = {
                "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏": {
                    investmentAmount: Math.floor(Math.random() * 500000000) + 50000000,
                    historicalRoi: 15 + Math.random() * 20,
                    rdBudget: 25 + Math.random() * 20,
                    projectCount: Math.floor(Math.random() * 50) + 10,
                    customerCount: Math.floor(Math.random() * 500) + 50,
                    currentChurn: 5 + Math.random() * 15,
                    avgLtv: Math.floor(Math.random() * 3000000) + 500000,
                    infraCapex: Math.floor(Math.random() * 50000000) + 10000000
                },
                
                "–†–∏—Ç–µ–π–ª": {
                    investmentAmount: Math.floor(Math.random() * 300000000) + 30000000,
                    historicalRoi: 12 + Math.random() * 15,
                    rdBudget: 10 + Math.random() * 15,
                    projectCount: Math.floor(Math.random() * 20) + 5,
                    customerCount: Math.floor(Math.random() * 1000) + 100,
                    currentChurn: 10 + Math.random() * 20,
                    avgLtv: Math.floor(Math.random() * 800000) + 200000,
                    infraCapex: Math.floor(Math.random() * 30000000) + 5000000
                },
                
                "–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ": {
                    investmentAmount: Math.floor(Math.random() * 800000000) + 100000000,
                    historicalRoi: 10 + Math.random() * 12,
                    rdBudget: 15 + Math.random() * 20,
                    projectCount: Math.floor(Math.random() * 30) + 8,
                    customerCount: Math.floor(Math.random() * 300) + 30,
                    currentChurn: 8 + Math.random() * 12,
                    avgLtv: Math.floor(Math.random() * 2000000) + 500000,
                    infraCapex: Math.floor(Math.random() * 100000000) + 20000000
                },
                
                "–§–∏–Ω–∞–Ω—Å—ã": {
                    investmentAmount: Math.floor(Math.random() * 1000000000) + 100000000,
                    historicalRoi: 18 + Math.random() * 25,
                    rdBudget: 20 + Math.random() * 25,
                    projectCount: Math.floor(Math.random() * 40) + 10,
                    customerCount: Math.floor(Math.random() * 200) + 50,
                    currentChurn: 12 + Math.random() * 15,
                    avgLtv: Math.floor(Math.random() * 5000000) + 1000000,
                    infraCapex: Math.floor(Math.random() * 20000000) + 5000000
                }
            };
            
            const defaultMetrics = {
                investmentAmount: Math.floor(Math.random() * 500000000) + 50000000,
                historicalRoi: 12 + Math.random() * 18,
                rdBudget: 15 + Math.random() * 20,
                projectCount: Math.floor(Math.random() * 30) + 10,
                customerCount: Math.floor(Math.random() * 500) + 50,
                currentChurn: 8 + Math.random() * 15,
                avgLtv: Math.floor(Math.random() * 2000000) + 300000,
                infraCapex: Math.floor(Math.random() * 50000000) + 10000000
            };
            
            return baseMetrics[sector] || defaultMetrics;
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π
        function addRealCompanies() {
            const realCompanies = [
                {
                    inn: "7707049388",
                    name: "–û–û–û '–ú–æ–±–∞–π–ª –ü–∞—Ä–∫ –ò–¢' (–ú–ü–ò–¢)",
                    description: "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –∫–æ–º–ø–∞–Ω–∏—è, IoT –∏ —Ç–µ–ª–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è, PaaS –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞, 250+ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤",
                    sector: "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
                    logo: "–ú"
                },
                {
                    inn: "7710140679",
                    name: "–ü–ê–û '–ì–∞–∑–ø—Ä–æ–º'",
                    description: "–ö—Ä—É–ø–Ω–µ–π—à–∞—è –≥–∞–∑–æ–≤–∞—è –∫–æ–º–ø–∞–Ω–∏—è, –º–∏—Ä–æ–≤–æ–π –ª–∏–¥–µ—Ä –≤ —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–æ–º —Å–µ–∫—Ç–æ—Ä–µ",
                    sector: "–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞",
                    logo: "–ì"
                },
                {
                    inn: "7707049398",
                    name: "–ê–û '–Ø–Ω–¥–µ–∫—Å'",
                    description: "–ö—Ä—É–ø–Ω–µ–π—à–∞—è IT-–∫–æ–º–ø–∞–Ω–∏—è, –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–ø–æ–∏—Å–∫, —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç",
                    sector: "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
                    logo: "–Ø"
                },
                {
                    inn: "7702070139",
                    name: "–ü–ê–û '–°–±–µ—Ä–±–∞–Ω–∫'",
                    description: "–ö—Ä—É–ø–Ω–µ–π—à–∏–π –±–∞–Ω–∫, —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —É—Å–ª—É–≥–∏, —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏",
                    sector: "–§–∏–Ω–∞–Ω—Å—ã",
                    logo: "–°"
                },
                {
                    inn: "7724008320",
                    name: "–û–û–û '–ú–∞–≥–Ω–∏—Ç'",
                    description: "–ö—Ä—É–ø–Ω–µ–π—à–∞—è —Ä–æ–∑–Ω–∏—á–Ω–∞—è —Å–µ—Ç—å, –ø—Ä–æ–¥—É–∫—Ç—ã –ø–∏—Ç–∞–Ω–∏—è, —Ç–æ–≤–∞—Ä—ã –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–≥–æ —Å–ø—Ä–æ—Å–∞",
                    sector: "–†–∏—Ç–µ–π–ª",
                    logo: "–ú"
                },
                {
                    inn: "7830002293",
                    name: "–ü–ê–û '–õ—É–∫–æ–π–ª'",
                    description: "–ö—Ä—É–ø–Ω–∞—è –Ω–µ—Ñ—Ç—è–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è, –¥–æ–±—ã—á–∞ –∏ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ—Ñ—Ç–∏",
                    sector: "–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞",
                    logo: "–õ"
                }
            ];
            
            realCompanies.forEach((company) => {
                const sector = company.sector;
                const metrics = generateSectorMetrics(sector);
                
                companiesDatabase[company.inn] = {
                    id: `real_${company.inn}`,
                    name: company.name,
                    description: company.description,
                    sector: sector,
                    logo: company.logo,
                    investmentAmount: metrics.investmentAmount * 2,
                    historicalRoi: metrics.historicalRoi * 1.2,
                    rdBudget: metrics.rdBudget,
                    projectCount: metrics.projectCount * 3,
                    customerCount: metrics.customerCount * 10,
                    currentChurn: metrics.currentChurn * 0.8,
                    avgLtv: metrics.avgLtv * 2,
                    infraCapex: metrics.infraCapex * 5
                };
            });
        }

        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Å–µ–ª
        function formatNumber(num) {
            if (!num && num !== 0) return '‚Äî';
            const numValue = typeof num === 'number' ? num : parseFloat(num);
            if (isNaN(numValue)) return '‚Äî';
            
            if (numValue >= 1000000000) {
                return (numValue / 1000000000).toFixed(2).replace('.', ',') + ' –º–ª—Ä–¥';
            }
            
            if (numValue >= 1000000) {
                return (numValue / 1000000).toFixed(1).replace('.', ',') + ' –º–ª–Ω';
            }
            
            return numValue.toLocaleString('ru-RU', {
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            });
        }

        // –ü–æ–ª—É—á–∏—Ç—å –∫–ª–∞—Å—Å –¥–ª—è —Å–µ–∫—Ç–æ—Ä–∞
        function getSectorClass(sector) {
            const classes = {
                "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏": "sector-tech",
                "–†–∏—Ç–µ–π–ª": "sector-retail",
                "–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ": "sector-manufacturing",
                "–§–∏–Ω–∞–Ω—Å—ã": "sector-finance",
                "–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞": "sector-energy",
                "–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ": "sector-construction"
            };
            return classes[sector] || "sector-tech";
        }

        // –ü–æ–ª—É—á–∏—Ç—å —Ü–≤–µ—Ç –¥–ª—è –ª–æ–≥–æ—Ç–∏–ø–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–µ–∫—Ç–æ—Ä–∞
        function getSectorColor(sector) {
            const colors = {
                "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏": "#4285f4",
                "–†–∏—Ç–µ–π–ª": "#ea4335",
                "–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ": "#fbbc05",
                "–§–∏–Ω–∞–Ω—Å—ã": "#34a853",
                "–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞": "#8b4513",
                "–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ": "#ff6b35"
            };
            return colors[sector] || "#d32f2f";
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function updateStats() {
            const totalCompanies = Object.keys(companiesDatabase).length;
            
            // –ü–æ–¥—Å—á–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π (ROI > 10%)
            let activeCount = 0;
            Object.values(companiesDatabase).forEach(company => {
                if (company.historicalRoi > 10) {
                    activeCount++;
                }
            });
            
            document.getElementById('statTotal').textContent = totalCompanies.toLocaleString();
            document.getElementById('statActive').textContent = activeCount.toLocaleString();
            document.getElementById('statUpdated').textContent = new Date().toLocaleDateString('ru-RU');
        }

        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ç–∞–±–ª–∏—Ü—ã –∫–æ–º–ø–∞–Ω–∏–π
        function renderCompaniesTable() {
            const tableBody = document.getElementById('companiesTableBody');
            const pagination = document.getElementById('pagination');
            
            // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ–º–ø–∞–Ω–∏–π
            let filteredCompanies = Object.entries(companiesDatabase).map(([inn, company]) => ({ inn, ...company }));
            
            // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ –ø–æ —Å–µ–∫—Ç–æ—Ä—É
            if (currentFilter !== 'all') {
                filteredCompanies = filteredCompanies.filter(item => item.sector === currentFilter);
            }
            
            // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–æ–∏—Å–∫–∞
            if (currentSearch) {
                const searchLower = currentSearch.toLowerCase();
                filteredCompanies = filteredCompanies.filter(item => 
                    item.name.toLowerCase().includes(searchLower) || 
                    item.sector.toLowerCase().includes(searchLower) ||
                    item.inn.includes(currentSearch) ||
                    item.description.toLowerCase().includes(searchLower)
                );
            }
            
            // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–ø–∞–Ω–∏–π
            totalCompanies = filteredCompanies.length;
            const totalPages = Math.ceil(totalCompanies / companiesPerPage);
            
            // –ü–∞–≥–∏–Ω–∞—Ü–∏—è
            const startIndex = (currentPage - 1) * companiesPerPage;
            const endIndex = startIndex + companiesPerPage;
            const companiesToShow = filteredCompanies.slice(startIndex, endIndex);
            
            // –û—á–∏—Å—Ç–∫–∞ —Ç–∞–±–ª–∏—Ü—ã
            tableBody.innerHTML = '';
            
            // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
            companiesToShow.forEach((company) => {
                const roi = company.historicalRoi;
                const roiClass = roi >= 15 ? 'roi-positive' : (roi >= 10 ? '' : 'roi-negative');
                const sectorColor = getSectorColor(company.sector);
                
                const row = document.createElement('tr');
                row.className = 'company-row';
                row.onclick = () => showCompanyDetails(company.inn);
                
                row.innerHTML = `
                    <td>
                        <div class="company-name-cell">
                            <div class="company-logo-small" style="background: linear-gradient(135deg, ${sectorColor} 0%, ${sectorColor}99 100%);">
                                ${company.logo}
                            </div>
                            <div class="company-info">
                                <div class="company-name">${company.name}</div>
                                <div class="company-desc">${company.description}</div>
                            </div>
                        </div>
                    </td>
                    <td><span class="sector-badge ${getSectorClass(company.sector)}">${company.sector}</span></td>
                    <td><div class="inn-cell">${company.inn}</div></td>
                    <td class="metric-value-cell roi-cell ${roiClass}">${roi.toFixed(1)}%</td>
                    <td class="metric-value-cell">${formatNumber(company.investmentAmount)}</td>
                    <td class="metric-value-cell">${company.customerCount.toLocaleString()}</td>
                    <td class="metric-value-cell">${company.rdBudget}%</td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
            renderPagination(pagination, totalPages, currentPage);
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            updateStats();
        }

        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
        function renderPagination(container, totalPages, currentPage) {
            container.innerHTML = '';
            
            if (totalPages <= 1) return;
            
            // –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥"
            const prevBtn = document.createElement('button');
            prevBtn.className = 'page-btn';
            prevBtn.innerHTML = '‚Üê –ù–∞–∑–∞–¥';
            prevBtn.disabled = currentPage === 1;
            prevBtn.onclick = () => {
                if (currentPage > 1) {
                    currentPage--;
                    renderCompaniesTable();
                }
            };
            container.appendChild(prevBtn);
            
            // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
            const pageInfo = document.createElement('span');
            pageInfo.className = 'page-info';
            pageInfo.textContent = `–°—Ç—Ä–∞–Ω–∏—Ü–∞ ${currentPage} –∏–∑ ${totalPages}`;
            container.appendChild(pageInfo);
            
            // –ö–Ω–æ–ø–∫–∞ "–í–ø–µ—Ä–µ–¥"
            const nextBtn = document.createElement('button');
            nextBtn.className = 'page-btn';
            nextBtn.innerHTML = '–í–ø–µ—Ä–µ–¥ ‚Üí';
            nextBtn.disabled = currentPage === totalPages;
            nextBtn.onclick = () => {
                if (currentPage < totalPages) {
                    currentPage++;
                    renderCompaniesTable();
                }
            };
            container.appendChild(nextBtn);
        }

        // –ü–æ–∏—Å–∫ –∫–æ–º–ø–∞–Ω–∏–π
        function searchCompanies() {
            currentSearch = document.getElementById('searchInput').value;
            currentPage = 1;
            renderCompaniesTable();
        }

        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å–µ–∫—Ç–æ—Ä—É
        function filterBySector() {
            currentFilter = document.getElementById('sectorFilter').value;
            currentPage = 1;
            renderCompaniesTable();
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª–∏ –∫–æ–º–ø–∞–Ω–∏–∏
        function showCompanyDetails(inn) {
            const company = companiesDatabase[inn];
            if (!company) return;
            
            const message = `
–ö–æ–º–ø–∞–Ω–∏—è: ${company.name}
–ò–ù–ù: ${inn}
–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: ${company.sector}
–û–ø–∏—Å–∞–Ω–∏–µ: ${company.description}

–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:
‚Ä¢ ROI: ${company.historicalRoi.toFixed(1)}%
‚Ä¢ –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏: ${formatNumber(company.investmentAmount)}
‚Ä¢ –ë—é–¥–∂–µ—Ç R&D: ${company.rdBudget}%
‚Ä¢ –ê–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã: ${company.projectCount}
‚Ä¢ –ö–ª–∏–µ–Ω—Ç—ã: ${company.customerCount.toLocaleString()}
‚Ä¢ –û—Ç—Ç–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤: ${company.currentChurn.toFixed(1)}%
‚Ä¢ –°—Ä–µ–¥–Ω–∏–π LTV: ${formatNumber(company.avgLtv)}
‚Ä¢ CAPEX –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞: ${formatNumber(company.infraCapex)}
            `;
            
            alert(message);
        }

        // –î–æ–±–∞–≤–∏—Ç—å —Å–ª—É—á–∞–π–Ω—É—é –∫–æ–º–ø–∞–Ω–∏—é
        function addRandomCompany() {
            const sector = companyDataGenerator.sectors[Math.floor(Math.random() * companyDataGenerator.sectors.length)];
            let inn;
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –ò–ù–ù
            do {
                inn = companyDataGenerator.generateINN();
            } while (companiesDatabase[inn]);
            
            const name = companyDataGenerator.generateCompanyName();
            const description = companyDataGenerator.generateDescription(sector);
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫
            const metrics = generateSectorMetrics(sector);
            
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
            companiesDatabase[inn] = {
                id: `custom_${Date.now()}`,
                name: name,
                description: description,
                sector: sector,
                logo: name.charAt(0),
                investmentAmount: metrics.investmentAmount,
                historicalRoi: metrics.historicalRoi,
                rdBudget: metrics.rdBudget,
                projectCount: metrics.projectCount,
                customerCount: metrics.customerCount,
                currentChurn: metrics.currentChurn,
                avgLtv: metrics.avgLtv,
                infraCapex: metrics.infraCapex
            };
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
            renderCompaniesTable();
            
            showNotification(`–ö–æ–º–ø–∞–Ω–∏—è "${name}" —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö`, 'success');
        }

        // –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π
        function importExternalData() {
            showNotification('–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤...', 'info');
            
            // –°–∏–º—É–ª—è—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
            setTimeout(() => {
                const additionalCompanies = [
                    {
                        inn: "7708123456",
                        name: "–û–û–û '–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –ë—É–¥—É—â–µ–≥–æ'",
                        desc: "–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –≤ –æ–±–ª–∞—Å—Ç–∏ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞",
                        sector: "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏"
                    },
                    {
                        inn: "7715987654",
                        name: "–ê–û '–≠–Ω–µ—Ä–≥–æ–°–µ—Ä–≤–∏—Å'",
                        desc: "–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã",
                        sector: "–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞"
                    }
                ];
                
                let addedCount = 0;
                additionalCompanies.forEach(company => {
                    if (!companiesDatabase[company.inn]) {
                        const metrics = generateSectorMetrics(company.sector);
                        
                        companiesDatabase[company.inn] = {
                            id: `import_${Date.now()}_${addedCount}`,
                            name: company.name,
                            description: company.desc,
                            sector: company.sector,
                            logo: company.name.charAt(0),
                            investmentAmount: metrics.investmentAmount,
                            historicalRoi: metrics.historicalRoi,
                            rdBudget: metrics.rdBudget,
                            projectCount: metrics.projectCount,
                            customerCount: metrics.customerCount,
                            currentChurn: metrics.currentChurn,
                            avgLtv: metrics.avgLtv,
                            infraCapex: metrics.infraCapex
                        };
                        addedCount++;
                    }
                });
                
                renderCompaniesTable();
                showNotification(`–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ ${addedCount} –Ω–æ–≤—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π`, 'success');
            }, 1500);
        }

        // –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV
        function exportToCSV() {
            const headers = ['–ò–ù–ù', '–ù–∞–∑–≤–∞–Ω–∏–µ', '–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ', 'ROI (%)', '–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ (—Ä—É–±)', '–ö–ª–∏–µ–Ω—Ç—ã', '–ë—é–¥–∂–µ—Ç R&D (%)', '–ü—Ä–æ–µ–∫—Ç—ã', '–û—Ç—Ç–æ–∫ (%)', 'LTV (—Ä—É–±)', 'CAPEX (—Ä—É–±)'];
            
            let csvContent = headers.join(';') + '\n';
            
            Object.entries(companiesDatabase).forEach(([inn, company]) => {
                const row = [
                    inn,
                    `"${company.name}"`,
                    company.sector,
                    company.historicalRoi.toFixed(1),
                    company.investmentAmount,
                    company.customerCount,
                    company.rdBudget,
                    company.projectCount,
                    company.currentChurn.toFixed(1),
                    company.avgLtv,
                    company.infraCapex
                ];
                csvContent += row.join(';') + '\n';
            });
            
            const blob = new Blob(['\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.setAttribute('href', url);
            link.setAttribute('download', `–±–∞–∑–∞_–∫–æ–º–ø–∞–Ω–∏–π_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification(`–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ ${Object.keys(companiesDatabase).length} –∫–æ–º–ø–∞–Ω–∏–π –≤ CSV`, 'info');
        }

        // –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
        function exportToExcel() {
            showNotification('–≠–∫—Å–ø–æ—Ä—Ç –≤ Excel –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏', 'info');
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞
        function generateReport() {
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å–µ–∫—Ç–æ—Ä–∞–º
            const sectorStats = {};
            let totalInvestment = 0;
            let totalRoi = 0;
            let totalCustomers = 0;
            
            Object.values(companiesDatabase).forEach(company => {
                if (!sectorStats[company.sector]) {
                    sectorStats[company.sector] = {
                        count: 0,
                        totalInvestment: 0,
                        avgRoi: 0,
                        totalCustomers: 0
                    };
                }
                
                sectorStats[company.sector].count++;
                sectorStats[company.sector].totalInvestment += company.investmentAmount;
                sectorStats[company.sector].avgRoi += company.historicalRoi;
                sectorStats[company.sector].totalCustomers += company.customerCount;
                
                totalInvestment += company.investmentAmount;
                totalRoi += company.historicalRoi;
                totalCustomers += company.customerCount;
            });
            
            // –†–∞—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
            Object.keys(sectorStats).forEach(sector => {
                sectorStats[sector].avgRoi = sectorStats[sector].avgRoi / sectorStats[sector].count;
            });
            
            const avgRoi = totalRoi / Object.keys(companiesDatabase).length;
            
            // –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–∞
            let report = `–û–¢–ß–ï–¢ –ü–û –ë–ê–ó–ï –î–ê–ù–ù–´–• –ö–û–ú–ü–ê–ù–ò–ô\n`;
            report += `–î–∞—Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: ${new Date().toLocaleDateString('ru-RU')}\n`;
            report += `========================================\n\n`;
            report += `–û–ë–©–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê:\n`;
            report += `‚Ä¢ –í—Å–µ–≥–æ –∫–æ–º–ø–∞–Ω–∏–π: ${Object.keys(companiesDatabase).length.toLocaleString()}\n`;
            report += `‚Ä¢ –û–±—â–∏–π –æ–±—ä–µ–º –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π: ${formatNumber(totalInvestment)}\n`;
            report += `‚Ä¢ –°—Ä–µ–¥–Ω–∏–π ROI: ${avgRoi.toFixed(1)}%\n`;
            report += `‚Ä¢ –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∏–µ–Ω—Ç–æ–≤: ${totalCustomers.toLocaleString()}\n\n`;
            
            report += `–°–¢–ê–¢–ò–°–¢–ò–ö–ê –ü–û –ù–ê–ü–†–ê–í–õ–ï–ù–ò–Ø–ú:\n`;
            Object.entries(sectorStats).forEach(([sector, stats]) => {
                const investmentShare = (stats.totalInvestment / totalInvestment * 100).toFixed(1);
                report += `\n${sector}:\n`;
                report += `  ‚Ä¢ –ö–æ–º–ø–∞–Ω–∏–π: ${stats.count} (${((stats.count / Object.keys(companiesDatabase).length) * 100).toFixed(1)}%)\n`;
                report += `  ‚Ä¢ –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏: ${formatNumber(stats.totalInvestment)} (${investmentShare}%)\n`;
                report += `  ‚Ä¢ –°—Ä–µ–¥–Ω–∏–π ROI: ${stats.avgRoi.toFixed(1)}%\n`;
                report += `  ‚Ä¢ –ö–ª–∏–µ–Ω—Ç—ã: ${stats.totalCustomers.toLocaleString()}\n`;
            });
            
            report += `\n========================================\n`;
            report += `–¢–û–ü-10 –ö–û–ú–ü–ê–ù–ò–ô –ü–û ROI:\n\n`;
            
            // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ ROI
            const sortedByRoi = Object.entries(companiesDatabase)
                .map(([inn, company]) => ({ inn, ...company }))
                .sort((a, b) => b.historicalRoi - a.historicalRoi)
                .slice(0, 10);
            
            sortedByRoi.forEach((company, index) => {
                report += `${index + 1}. ${company.name} (${company.sector})\n`;
                report += `   –ò–ù–ù: ${company.inn}\n`;
                report += `   ROI: ${company.historicalRoi.toFixed(1)}%\n`;
                report += `   –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏: ${formatNumber(company.investmentAmount)}\n`;
                report += `   –ö–ª–∏–µ–Ω—Ç—ã: ${company.customerCount.toLocaleString()}\n\n`;
            });
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç—á–µ—Ç
            alert(report);
            
            // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —Å–∫–∞—á–∞—Ç—å –æ—Ç—á–µ—Ç –∫–∞–∫ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª
            const blob = new Blob([report], { type: 'text/plain;charset=utf-8' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.setAttribute('href', url);
            link.setAttribute('download', `–æ—Ç—á–µ—Ç_–±–∞–∑—ã_–∫–æ–º–ø–∞–Ω–∏–π_${new Date().toISOString().split('T')[0]}.txt`);
            link.style.visibility = 'hidden';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('–û—Ç—á–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∏ —Å–∫–∞—á–∞–Ω', 'success');
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
            initializeDatabase();
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ Enter –¥–ª—è –ø–æ–∏—Å–∫–∞
            document.getElementById('searchInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    searchCompanies();
                }
            });
        });
    </script>
</body>
</html>
